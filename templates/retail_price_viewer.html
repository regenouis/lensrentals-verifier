<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lensrentals Product Verifier</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    input, button { margin: 0.5rem 0; padding: 0.5rem; font-size: 1rem; }
    .summary a { color: #007BFF; text-decoration: none; }
  </style>
</head>
<body onload="resetFields()">
  <h2>üîç Lensrentals Product Verifier</h2>
  <form id="lookupForm">
    <input type="text" id="productName" placeholder="e.g., Sony FX3" />
    <br />
    <input type="text" id="mpn" placeholder="e.g., ILME-FX3" />
    <span>Enter a product name or MPN ‚Äî one is required.</span>
    <br />
    <button type="submit">Check Prices</button>
    <button type="button" onclick="resetFields()">Reset</button>
  </form>

  <div id="results" class="summary" style="margin-top: 2rem;"></div>

  <script>
    function resetFields() {
      document.getElementById('productName').value = '';
      document.getElementById('mpn').value = '';
      document.getElementById('results').innerHTML = '';
    }

    document.getElementById('lookupForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      const product_name = document.getElementById('productName').value.trim();
      const mpn = document.getElementById('mpn').value.trim();

      if (!product_name && !mpn) {
        alert("Please enter either a product name or MPN.");
        return;
      }

      const response = await fetch('/lookup', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ product_name, mpn })
      });

      const data = await response.json();

      if (data.error) {
        document.getElementById('results').innerHTML = `<p style="color:red;">${data.error}</p>`;
        return;
      }

      document.getElementById('results').innerHTML = `
        <h3>üß∑ Pricing Summary</h3>
        <p><strong>B&H Photo:</strong> ${data.bh_photo}</p>
        <p><strong>Adorama:</strong> ${data.adorama}</p>
        <p><strong>eBay Sold:</strong> ${data.ebay_sold}</p>
        <p><strong>MPB:</strong> ${data.mpb}</p>
      `;
    });
  </script>
</body>
</html>
